<h3 class="page-header">HDF5 Data Files</h3>
<p>
The HDF5 file format is a portable and extensible binary data format designed for complex data. It supports an unlimited variety of datatypes and flexible and efficient methods for data retrieval and storage. HDF5 features a hierarchical structure that allows access to chunks of data without loading the entire file into memory. The Data Recorder module outputs to an HDF5 file. 
</p>

<p>
At the topmost level, an RTXI HDF5 file is divided into separate <i>Trial</i> groups, each of which contains the system settings and module parameter values that existed at the time that data was recorded. The Data Recorder only saves parameter values for modules from which it is recording a signal. A new <i>Trial</i> is created whenever the Data Recorder is used to start recording. For example, if you stop and start recording multiple times in a single session, RTXI automatically increments the trial number each time. If you choose to save data to a file that already exists, RTXI will prompt you with a choice to overwrite the file or append new data to the file. Appending data to a file also creates a new <i>Trial</i>. Thus, it is possible to have trials within the same file that contain different parameter settings and even data downsampling rates.
</p>

<p>
Parameter values from user modules are saved in the <i>Parameters</i> group within each <i>Trial</i>. The name of each parameter includes the module instance ID number within RTXI, the name of the module, and the name of the parameter itself. If the value of the parameter changes during recording, all the values are saved with a corresponding index value that is the timestamp in nanoseconds from the start of the recording. This feature is only available for user modules that are based on the  <code>DefaultGUIModel</code> class. Note that certain naming conventions for parameters also apply in order for them to be captured to HDF5.
</p>

<p>
Real-time signals in RTXI are streamed to the <i>Synchronous Data</i> structure within each <i>Trial</i>. This group contains separate fields with the name of each synchronous channel and a single dataset that contains all the synchronous data. The order of the channel names corresponds with the columns in the dataset.
</p>

<figure class="figure">
	<img src="{{ site.img }}/manual/axoclamptutorial5.png" class="figure-img img-fluid">
	<figcaption class="figure-caption">RTXI uses a hierarchical HDF5 data structure organized into <i>Trials</i>. Each <i>Trial</i> contains the system settings and parameter values for that trial. This screenshot is taken using HDFView, a free software for browsing HDF5 files.
	</figcaption>
</figure>

<p>
There are various software available for working with HDF5 files. To simply browse the file structure, you can use the free HDFView application:
</p>

{% highlight bash %}
$ sudo apt-get install hdfview
{% endhighlight %}

<p>
HDFView provides some limited editing capabilities. For trials where only a single channel is saved, you can also preview a plot of the data. To extract the data for analysis and for complete editing capabilities, APIs are available for MATLAB, GNU Octave, Igor Pro, Mathematica, Python, Scilab, and other software.  
</p>

<p>
RTXI also includes a simple MATLAB GUI for quickly viewing the data within a single trial. The MATLAB code is available in the <a href="https://github.com/rtxi/analysis-tools">Analysis Tools repository</a>. A sample m-file called <code>example.m</code> provides examples of how to extract data to the MATLAB workspace, use the GUI browser, and add new datasets to your file. It is also possible to embed binary formats, such as images, within a trial.
</p>

<p>
The GUI browser allows you to view the parameters, channels, and plots of the data within a single trial with the <code>rtxibrowse()</code> function. This generates a MATLAB figure window with the filename and trial number in the menu bar. To browse trials within the same HDF5 file, use the buttons in the lower left corner. The left panel lists the initial values for all the module parameters. If a parameter value has changed during the recording, this is denoted with an asterisk. The new values and their timestamps can be viewed by using the <code>getTrial()</code> function, which returns a MATLAB structure containing all the information within a trial. The GUI plots two channels from the same trial. Use the middle upper and and lower panels to select the data that is plotted in the right upper and lower panels. Double-clicking on a channel name in the middle panel will create a new figure window with that data plotted. This allows you to continue browsing through other trials in the main GUI window while keeping this additional plot available.
</p>

<figure class="figure">
	<img src="{{ site.img }}/manual/axoclamptutorial6.png" class="figure-img img-fluid">
	<figcaption class="figure-caption">The MATLAB GUI browser allows you to view the parameters, channels, and plots of the data within a single trial.
	</figcaption>
</figure>
