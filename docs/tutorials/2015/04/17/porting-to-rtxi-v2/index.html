<!DOCTYPE html><html lang="en" itemscope itemtype="http://scheme.org/Article"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta itemprop="name" content="Porting to RTXI v2.0"><meta itemprop="description" content="RTXI v2.0 has been in development for a while, and its release will introduce many changes in the current v1.4 release. Most of these changes should have a limited impact on your modules, but even ..."><meta itemprop="image" content="http://rtxi.org/assets/img/rtxi-logo-square.png"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Porting to RTXI v2.0"><meta name="twitter:description" content="RTXI v2.0 has been in development for a while, and its release will introduce many changes in the current v1.4 release. Most of these changes should have a limited impact on your modules, but even ..."><meta name="twitter:image:src" content="http://rtxi.org/assets/img/rtxi-logo-square.png"><meta property="og:title" content="Porting to RTXI v2.0"><meta property="og:type" content="article"><meta property="og:url" content="http://rtxi.org/docs/tutorials/2015/04/17/porting-to-rtxi-v2/"><meta property="og:image" content="http://rtxi.org/assets/img/rtxi-logo-square.png"><meta property="og:description" content="RTXI v2.0 has been in development for a while, and its release will introduce many changes in the current v1.4 release. Most of these changes should have a limited impact on your modules, but even ..."><meta property="og:site_name" content="RTXI | The Real-time eXperiment Interface"><meta property="article:section" content=""><meta property="article:tag" content=""><title>Porting to RTXI v2.0 | The Real-time eXperiment Interface</title><link href="/assets/css/default.min.css" rel="stylesheet"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="icon" href="/favicon.ico"></head><style>h1, h2, h3, h4, h5, h6 {
			padding-bottom: 9px;
			margin: 40px 0 20px;
			border-bottom: 1px solid #eee;
			font-weight: normal;
		}
		img {
			margin-left: auto;
			margin-right: auto;
			display: block;
			max-width: 100%;
			height: auto;
		}</style><style>body {
   padding-top:50px;
   padding-bottom:30px;
}</style><nav class="navbar navbar-inverse navbar-fixed-top" role="navigation"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand" rel="home" href="/"><b>RTXI</b></a></div><div class="row"><div id="navbar" class="navbar-collapse collapse navbar-right" style="text-align:center"><ul class="nav navbar-nav"><li><a href="/install/">Install</a></li><li><a href="/modules/">Modules</a></li><li><a href="/papers/">Papers</a></li><li class="active"><a href="/docs/">Docs</a></li><li><a href="/stats/">Stats</a></li><li><a href="/community/">Community</a></li><li><a href="/contact/">Contact</a></li><li><a href="/feed.xml"><i class="fa fa-rss fa-inverse"></i></a></li></ul></div></div></div></nav><body style="padding-top:30px"><div class="container"><h3 class="page-header">Porting to RTXI v2.0</h3><p>RTXI v2.0 has been in development for a while, and its release will introduce many changes in the current v1.4 release. Most of these changes should have a limited impact on your modules, but even in that case, you will need to make some edits to your code to port it to v2.0. This tutorial will focus on some common changes that should cover most use-cases. The changes mostly have to do with:</p><ol><li>Upgrading from Qt3 to Qt4</li><li>Upgrading Qwt5 to Qwt6</li><li>Changes to the DefaultGUIModel class</li></ol><h4 id="upgrading-from-qt3-to-qt4">Upgrading from Qt3 to Qt4</h4><p>Qt3 is an old version of the Qt library. It was released in 2001 and superceded by Qt4 in 2005. It introduced many breaking changes to its API and classes, so it’s taken a while to upgrade RTXI’s codebase to properly use Qt4. We recommend that you look through the documentation Nokia provides on its website for porting from Qt3 to Qt4: <a href="http://doc.qt.io/qt-4.8/porting4.html">http://doc.qt.io/qt-4.8/porting4.html</a>.</p><h4 id="porting-modules-that-abstract-from-defaultguimodel">Porting Modules that Abstract from <code>DefaultGUIModel</code></h4><p>For v2.0, the code exposed to users has been simplified and the customizability enhanced. The most significant change is in the <code>createGUI</code> function and how the UI is generated. There are also some simple changes that correspond to syntax and class name changes in Qt4. They are as follows:</p><p><strong>1. Change <code>#includes</code></strong><br>Libraries for Qt4 are included differently. To include them directly, change the names as indicated in the Qt4 documentation. For example, <code>&lt;qpushbutton.h&gt;</code> becomes <code>&lt;QPushButton&gt;</code>. Look through the Qt4 documentation to see what the name changes are. Another, simpler option is to just remove all the q* includes and replace them with <code>&lt;QtGui&gt;</code>. <code>QtGui</code> will make Qt pull in all the libraries needed to compile whatever Qt classes are present in the code without the need to specify them directly.</p><p>Essentially, something like:</p><div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;main_window.h&gt;</span>
<span class="cp">#include &lt;qgridview.h&gt;</span>
<span class="cp">#include &lt;qhbox.h&gt;</span>
<span class="cp">#include &lt;qhbuttongroup.h&gt;</span>
<span class="cp">#include &lt;qlabel.h&gt;</span>
<span class="cp">#include &lt;qlayout.h&gt;</span>
<span class="cp">#include &lt;qpushbutton.h&gt;</span>
<span class="cp">#include &lt;qtimer.h&gt;</span>
<span class="cp">#include &lt;qtooltip.h&gt;</span>
<span class="cp">#include &lt;qvalidator.h&gt;</span>
<span class="cp">#include &lt;qvbox.h&gt;</span>
<span class="cp">#include &lt;qwhatsthis.h&gt;</span></code></pre></div><div style="text-align:center">becomes<br>&nbsp;</div><div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="cp">#include &lt;main_window.h&gt;</span>
<span class="cp">#include &lt;QtGui&gt;</span></code></pre></div><div>&nbsp;</div><p><strong>2. Change <code>QWhatsThis</code></strong><br>This call is made by default in the constructors of module classes that abstract from DefaultGUIModel. Change:</p><div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">QWhatsThis</span><span class="o">::</span><span class="n">add</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="s">&quot;text&quot;</span><span class="p">);</span></code></pre></div><div style="text-align:center">to<br>&nbsp;</div><div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">setWhatsThis</span><span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">);</span></code></pre></div><div>&nbsp;</div><p><strong>3. Add a resize timer</strong><br>At the end of the contructor, after the module has been built and the <code>refresh</code> function has been called, add the line:</p><div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">QTimer</span><span class="o">::</span><span class="n">singleShot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="n">SLOT</span><span class="p">(</span><span class="n">resizeMe</span><span class="p">()));</span></code></pre></div><div>&nbsp;</div><p><strong>4. Switch to <code>createGUI + customizeGUI</code> API</strong><br>In v1.4, the GUI is created using DefaultGUIModel’s <code>createGUI</code> function. If you wanted to add any custom elements, you had to overload the function and copy/paste the code in the <code>default_gui_model.cpp</code> and then add your own stuff. That’s changed now.</p><p>You no longer should overload the <code>createGUI</code> function. Now, just call DefaultGUIModel’s <code>createGUI</code> function and then call a new function, <code>customizeGUI</code>, to, well, customize it.</p><p>Define <code>customizeGUI</code> within the modules you are building. Call it <strong>after</strong> <code>createGUI</code> returns. To use <code>customizeGUI</code> properly, you need to do:</p><ol><li><p>Grab the module layout object created by <code>createGUI</code>:</p><div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">QGridLayout</span> <span class="o">*</span><span class="n">customLayout</span> <span class="o">=</span> <span class="n">DefaultGUIModel</span><span class="o">::</span><span class="n">getLayout</span><span class="p">();</span></code></pre></div></li><li><p>Add custom elements to the layout. For more explanation about this, see the example <code>customizeGUI</code> function defined in the plugin template.<br><a href="/docs/tutorials/2015/04/15/understanding-plugin-template/">http://rtxi.org/docs/tutorials/2015/04/15/understanding-plugin-template/</a></p></li><li><p>Set the edited layout.</p><div class="highlight"><pre><code class="language-cpp" data-lang="cpp"><span class="n">setLayout</span><span class="p">(</span><span class="n">customLayout</span><span class="p">);</span></code></pre></div></li></ol><div>&nbsp;</div><p><strong>5. Enforce types for get/set methods on RTXI workspace variables</strong><br>RTXI workspace variables are displayed in the UI as <code>QStrings</code>, and within the code they are regularly converted to the native types they are supposed to represent in memory, such as <code>int</code>, <code>double</code>, and <code>string</code>. v2.0 should take the calls in v1.4 without issue, but if you run into problems, check the types of the variables you are using.</p><p><strong>Note:</strong> v2.0 <strong>does not</strong> support strings for <code>PARAMETER</code> variables. Use the <code>COMMENT</code> type instead.</p></div></body><style>html {
  position: relative;
  min-height: 100%;
}
body {
  margin-bottom: 60px;
  margin-top: 10px;
}
.footer {
  position: absolute;
  top: 100%;
  bottom: auto;
  width: 100%;
  height: -60px;
  background-color: #c1c1c1;
}</style><div class="footer"><div class="container"><div class="row"><div class="col-sm-6 text-center" style="margin-top:50px; margin-bottom:10px"><a href="http://www.nih.gov/"><img class="img-responsive" src="/assets/img/nih-logo-trans.svg"></a></div><div class="col-sm-6 text-center" style="margin-top:55px"><a href="https://github.com/rtxi"><img class="img-responsive" src="/assets/img/github-logo.svg"></a></div></div><div style="margin-bottom:40px"></div></div></div><script src="/assets/js/default.min.js"></script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-5550734-5', 'auto');
		ga('send', 'pageview');</script></html>